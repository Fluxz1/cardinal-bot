generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

model User {
  id                     Int             @id @default(sequence(maxValue: 4294967295))
  userId                 String          @unique
  tasksCompletedLifetime Int             @default(0)
  tasksCompleted         Int             @default(0)
  pointsEarnedLifetime   Int             @default(0)
  pointsEarned           Int             @default(0)
  positionInFaction      FactionPosition @default(member)
  faction                Faction?        @relation(fields: [factionId], references: [id])
  factionId              Int?
  createdAt              DateTime        @default(now())

  @@index([factionId])
}

model Guild {
  guildId      String @id
  prefix       String @default(">")
  eventManager String @default("0")
  staff        String @default("0")
  moderator    String @default("0")
  admin        String @default("0")
}

model Faction {
  id          Int           @id @default(sequence(maxValue: 4294967295))
  ownerId     String
  level       Int           @default(0)
  status      FactionStatus @default(open)
  tag         String
  description String
  name        String        @unique
  members     User[]

  createdAt DateTime @default(now())
}

model Blacklist {
  id        Int      @id @default(sequence(maxValue: 4294967295))
  userId    String   @unique
  reason    String   @default("")
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

enum FactionStatus {
  open
  restricted
  closed
}

enum FactionPosition {
  member
  senior
  co_leader
  leader
}

enum crdb_internal_region {
  aws_ap_southeast_1 @map("aws-ap-southeast-1")
  aws_us_west_2      @map("aws-us-west-2")
}
