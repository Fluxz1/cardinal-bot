// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

model User {
  id                     BigInt          @id @unique @default(autoincrement())
  userId                 String          @unique
  tasksCompletedLifetime Int             @default(0)
  tasksCompleted         Int             @default(0)
  pointsEarnedLifetime   Int             @default(0)
  pointsEarned           Int             @default(0)
  positionInFaction      FactionPosition @default(member)
  factionId              BigInt?
  faction                Faction?        @relation(fields: [factionId], references: [id])
  createdAt              DateTime        @default(now())

  @@index([userId])
  @@index([factionId])
}

model Guild {
  guildId      String @id
  prefix       String @default(">")
  eventManager String @default("0")
  staff        String @default("0")
  moderator    String @default("0")
  admin        String @default("0")
}

model Faction {
  id          BigInt        @id @unique @default(autoincrement())
  ownerId     String
  level       Int           @default(0)
  status      FactionStatus @default(open)
  tag         String
  description String
  name        String        @unique
  members     User[]
  createdAt   DateTime      @default(now())
}

model Blacklist {
  id        BigInt   @id @default(autoincrement())
  userId    String   @unique
  reason    String   @default("")
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

enum FactionStatus {
  open
  restricted
  closed
}

enum FactionPosition {
  member
  senior
  co_leader
  leader
}
